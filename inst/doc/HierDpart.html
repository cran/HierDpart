<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Xinghu Qin –School of Biology, University of St Andrews" />

<meta name="date" content="2019-10-03" />

<title>A Brief Tutorial on Landscape Genetic Analysis Using HierDpart</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A Brief Tutorial on Landscape Genetic Analysis Using HierDpart</h1>
<h4 class="author">Xinghu Qin –School of Biology, University of St Andrews</h4>
<h4 class="date">2019-10-03</h4>



<div id="instruction" class="section level1">
<h1>Instruction</h1>
<p>This vignette demonstrates how to use the latest version of HierDpart to do landscape genetic analysis. This package is designed for population geneticists and community geneticists to solve the gap between community ecology and population genetics - how to partition diversity across metrics and spatial scales, from genetic diversity to species diversity using an integrated method. The method, known as the unifying framework, has been explained in recent paper (Gaggiotti, O. E. et al, 2018, Evol Appl, 11:1176-1193). This package was developed to implement the hierarchical decomposition analysis using not only the common genetic metrics, such as He, Fst, allelic richness, but also new genetic metrics from the unifying framework.</p>
<p>Here, this vignette will briefly show how to do analyses using this package.</p>
</div>
<div id="practical-analyses" class="section level1">
<h1>Practical analyses</h1>
<p>HierDpart can read genepop files both in haploid and diploid which are quite common in genetics.</p>
<p>##Install HierDpart</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#Install from CRAN</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#install.packages(&quot;HierDpart&quot;)</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">## or you can get the latest version of HierDpart from github</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#library(devtools)</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#install_github(&quot;xinghuq/HierDpart&quot;)</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;HierDpart&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># example genepop file</span></a>
<a class="sourceLine" id="cb2-2" title="2">f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,<span class="dt">package=</span><span class="st">&#39;HierDpart&#39;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">infile &lt;-<span class="st"> </span><span class="kw">file.path</span>(f, <span class="st">&quot;Island.gen&quot;</span>)</a></code></pre></div>
<p>##Function to calculate genetic diversity profiles (q=0,1,2) qD is the function calculating genetic diversity profile (qD, q=0,1,2), the true diversities. If we want to calculate the allelic diversity profiles, we can do the following command line:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">qD</span>(infile,<span class="dt">q=</span><span class="dv">0</span>,<span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt;         pop1 pop2 pop3 pop4 pop5 pop6 pop7 pop8 pop9 pop10 pop11 pop12</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; locus1     2    3    2    3    3    2    2    5    5     4     5     3</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; locus2     9    9    8    7    7    7    8    4    5     5     6     7</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; locus3     8    9    8    7    8    8    8    8    9     9     7     6</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; locus4     8    8    8    7    5    6    7    8   10     9     8     5</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; locus5     7    7    9    6    7    5   10    6    9     6     7     7</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; locus6     4    6    5    6    6    3    5    4    6     6     6     5</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; locus7     6    5    6    6    8    7    4    6    7     4     5     4</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; locus8     9    8    9    9    9    8    7    8    6     9     7     5</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; locus9     5    6    8    6    8    6    6    6    6     7     6     5</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; locus10    9    8    7    7    8    6    6    6    6     8     7     7</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;         pop13 pop14 pop15 pop16</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; locus1      3     6     3     4</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; locus2      6     5     5     5</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; locus3      6     7     7     7</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; locus4      6     9     9    10</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; locus5      7     8     9     8</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; locus6      4     5     6     5</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt; locus7      4     5     4     5</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; locus8      5     3     6     4</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; locus9      4     8     8     6</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; locus10     6     6     7     8</span></a></code></pre></div>
<p>You can choose which diversity you want to get by defining the value of q.</p>
<p>##Plot diversity profiles If we want to plot the diversity profiles, we can do:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">qDplot</span>(infile,<span class="dt">q=</span><span class="st">&quot;all&quot;</span>,<span class="dt">ncode=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>##Hierarchical diversity and differentiation decomposition For geneticists studying landscape genetics, they may want to partition the metapopulation into different subpopulation, thus having several hierarchical groups. Now I am showing how to decompose genetic diversity into different hierarchical levels.</p>
<div id="hierarchical-allelic-richness-q0" class="section level2">
<h2>Hierarchical allelic richness (q=0)</h2>
<p>Here it is easy to define or delimit your structure (hierarchy), type ?HierAr will show you how to do that. Here, “nreg” is the number of aggregate ( or population) in your metapopulation, and “r” is the number of subaggregate (or subpopulation) in each aggregate.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">HAr=<span class="kw">HierAr</span>(infile, <span class="dt">nreg=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">print</span>(HAr)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; $Ar_pop</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;         Arpop 1 Arpop 2 Arpop 3 Arpop 4 Arpop 5 Arpop 6 Arpop 7 Arpop 8</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; locus1        2       3       2       3       3       2       2       5</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; locus2        9       9       8       7       7       7       8       4</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; locus3        8       9       8       7       8       8       8       8</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; locus4        8       8       8       7       5       6       7       8</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; locus5        7       7       9       6       7       5      10       6</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; locus6        4       6       5       6       6       3       5       4</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; locus7        6       5       6       6       8       7       4       6</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; locus8        9       8       9       9       9       8       7       8</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; locus9        5       6       8       6       8       6       6       6</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; locus10       9       8       7       7       8       6       6       6</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;         Arpop 9 Arpop 10 Arpop 11 Arpop 12 Arpop 13 Arpop 14 Arpop 15</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; locus1        5        4        5        3        3        6        3</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; locus2        5        5        6        7        6        5        5</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; locus3        9        9        7        6        6        7        7</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; locus4       10        9        8        5        6        9        9</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; locus5        9        6        7        7        7        8        9</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; locus6        6        6        6        5        4        5        6</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; locus7        7        4        5        4        4        5        4</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; locus8        6        9        7        5        5        3        6</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; locus9        6        7        6        5        4        8        8</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; locus10       6        8        7        7        6        6        7</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt;         Arpop 16</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt; locus1         4</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt; locus2         5</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; locus3         7</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt; locus4        10</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt; locus5         8</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; locus6         5</span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; locus7         5</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; locus8         4</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; locus9         6</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="co">#&gt; locus10        8</span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co">#&gt; $Hierareco</span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co">#&gt;         [,1]</span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#&gt; locus1     6</span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#&gt; locus2    11</span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#&gt; locus3    13</span></a>
<a class="sourceLine" id="cb5-43" title="43"><span class="co">#&gt; locus4    11</span></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co">#&gt; locus5    14</span></a>
<a class="sourceLine" id="cb5-45" title="45"><span class="co">#&gt; locus6     7</span></a>
<a class="sourceLine" id="cb5-46" title="46"><span class="co">#&gt; locus7    10</span></a>
<a class="sourceLine" id="cb5-47" title="47"><span class="co">#&gt; locus8    13</span></a>
<a class="sourceLine" id="cb5-48" title="48"><span class="co">#&gt; locus9    13</span></a>
<a class="sourceLine" id="cb5-49" title="49"><span class="co">#&gt; locus10   11</span></a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="co">#&gt; $Ar_reg</span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="co">#&gt;   Ar_region 1 Ar_region 2 Ar_region 3 Ar_region 4</span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="co">#&gt; 1         9.2         8.7           6         7.3</span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">#&gt; $Hierar_loc</span></a>
<a class="sourceLine" id="cb5-56" title="56"><span class="co">#&gt;         Ar_region 1 Ar_region 2 Ar_region 3 Ar_region 4</span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt; locus1            4           6           3           6</span></a>
<a class="sourceLine" id="cb5-58" title="58"><span class="co">#&gt; locus2           10           8           8           5</span></a>
<a class="sourceLine" id="cb5-59" title="59"><span class="co">#&gt; locus3           12          11           6           7</span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="co">#&gt; locus4            9          10           7          10</span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="co">#&gt; locus5           13          10           8          10</span></a>
<a class="sourceLine" id="cb5-62" title="62"><span class="co">#&gt; locus6            6           7           5           6</span></a>
<a class="sourceLine" id="cb5-63" title="63"><span class="co">#&gt; locus7            8           7           6           5</span></a>
<a class="sourceLine" id="cb5-64" title="64"><span class="co">#&gt; locus8           10          12           5           6</span></a>
<a class="sourceLine" id="cb5-65" title="65"><span class="co">#&gt; locus9           11           8           5          10</span></a>
<a class="sourceLine" id="cb5-66" title="66"><span class="co">#&gt; locus10           9           8           7           8</span></a>
<a class="sourceLine" id="cb5-67" title="67"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-68" title="68"><span class="co">#&gt; $Ar_ovell</span></a>
<a class="sourceLine" id="cb5-69" title="69"><span class="co">#&gt;       Art Arr    Arp</span></a>
<a class="sourceLine" id="cb5-70" title="70"><span class="co">#&gt; [1,] 10.9 7.8 6.3375</span></a></code></pre></div>
</div>
<div id="hierarchical-allelic-diversity-1dq1" class="section level2">
<h2>Hierarchical allelic diversity (^1D,q=1)</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">HiD=<span class="kw">HierD</span>(infile, <span class="dt">nreg=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">print</span>(HiD)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;           D_gamma D_alpha.2 D_alpha.1 D_beta.2 D_beta.1 Differentiation.2</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; Locus 1  3.193142  2.725683  2.547081 1.171501 1.070120         0.1234638</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; Locus 2  8.127991  5.570462  4.756040 1.459123 1.171240         0.2947130</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; Locus 3  9.182470  7.039348  5.851804 1.304449 1.202936         0.2073097</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; Locus 4  8.384311  6.830226  5.819550 1.227531 1.173669         0.1599041</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; Locus 5  8.815656  6.014476  5.031749 1.465740 1.195305         0.2982420</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; Locus 6  4.466209  3.846453  3.517153 1.161124 1.093627         0.1165235</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Locus 7  6.466375  4.320795  3.849778 1.496570 1.122349         0.3144786</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; Locus 8  8.193804  5.671722  4.805933 1.444677 1.180150         0.2869518</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; Locus 9  9.424112  5.279522  4.494791 1.785031 1.174587         0.4519619</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; Locus 10 8.429114  5.828401  5.117923 1.446214 1.138821         0.2877814</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt;          Differentiation.1</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; Locus 1         0.04546744</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; Locus 2         0.10604372</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; Locus 3         0.12395858</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; Locus 4         0.10743385</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; Locus 5         0.11968905</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; Locus 6         0.06004503</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; Locus 7         0.07743759</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; Locus 8         0.11112839</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; Locus 9         0.10795825</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">#&gt; Locus 10        0.08721245</span></a></code></pre></div>
<p>The result returns a list of hierarchical metrics, the first five metrics are diversities. It explains in the below section.</p>
</div>
<div id="hierarchical-heterozygosity-q2" class="section level2">
<h2>Hierarchical heterozygosity (q=2)</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">He=<span class="kw">HierHe</span>(infile, <span class="dt">nreg=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">print</span>(He)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; $HierHe_perloc</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt;              Ht   Hr 1   Hr 2   Hr 3   Hr 4     Hp</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; Locus 1  0.5937 0.4725 0.7302 0.4131 0.6587 0.5529</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Locus 2  0.8549 0.8508 0.6745 0.7738 0.7518 0.7665</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; Locus 3  0.8781 0.8251 0.8675 0.7884 0.8342 0.8173</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; Locus 4  0.8595 0.8164 0.8765 0.7348 0.8702 0.8149</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; Locus 5  0.8488 0.7230 0.7936 0.7808 0.8541 0.7557</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; Locus 6  0.7036 0.6288 0.7947 0.6910 0.5559 0.6546</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; Locus 7  0.8052 0.7524 0.7951 0.3291 0.6892 0.6873</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; Locus 8  0.8410 0.8593 0.8014 0.6530 0.5448 0.7424</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; Locus 9  0.8758 0.8058 0.7774 0.5692 0.7589 0.7355</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; Locus 10 0.8592 0.7907 0.7548 0.8044 0.8200 0.7754</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; $HierHr</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt;       Ho     Hs     Ht    Dst    Htp   Dstp    Fst   Fstp     Fis   Dest</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; 1 0.7450 0.7320 0.7525 0.0205 0.7559 0.0239 0.0272 0.0316 -0.0178 0.0892</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; 2 0.7512 0.7726 0.7866 0.0139 0.7912 0.0186 0.0177 0.0235  0.0277 0.0817</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; 3 0.6750 0.6521 0.6537 0.0016 0.6554 0.0033 0.0025 0.0050 -0.0351 0.0094</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; 4 0.7183 0.7217 0.7338 0.0121 0.7398 0.0181 0.0164 0.0245  0.0047 0.0650</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; $Hrperloc</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt;         [,1]   [,2]   [,3]   [,4]</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt;  [1,] 0.4725 0.7302 0.4131 0.6587</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt;  [2,] 0.8508 0.6745 0.7738 0.7518</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt;  [3,] 0.8251 0.8675 0.7884 0.8342</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt;  [4,] 0.8164 0.8765 0.7348 0.8702</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt;  [5,] 0.7230 0.7936 0.7808 0.8541</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt;  [6,] 0.6288 0.7947 0.6910 0.5559</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt;  [7,] 0.7524 0.7951 0.3291 0.6892</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt;  [8,] 0.8593 0.8014 0.6530 0.5448</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt;  [9,] 0.8058 0.7774 0.5692 0.7589</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; [10,] 0.7907 0.7548 0.8044 0.8200</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; $HieHr_overall</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt;         Ht      Hr     Hp</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; [1,] 0.812 0.73165 0.7302</span></a></code></pre></div>
</div>
<div id="hierarchical-fst-allelic-fixation" class="section level2">
<h2>Hierarchical Fst (allelic fixation)</h2>
<p>Besides the hierarchical diversity, this package also calculates hierarchical genetic differentiation measured by Fst and Delta D. The Delta D here, which corresponds to q=1, measures allelic differentiation. Now we are showing how to calculate the traditional hierarchical Fst and new hierarchical Delta D.</p>
<p>For Fst:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">Hier_Fst=<span class="kw">HierFst</span>(infile, <span class="dt">nreg=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">print</span>(Hier_Fst)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;           region        pop          Ind</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; Total  0.1077832 0.13154297  0.128481750</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; region 0.0000000 0.02663001  0.023198983</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; pop    0.0000000 0.00000000 -0.003524894</span></a></code></pre></div>
<p>This gives you the Fst among subaggregate within in aggregate. See ?HierFst for more details.</p>
</div>
<div id="hierarchical-delta-d" class="section level2">
<h2>Hierarchical Delta D</h2>
<p>For DeltaD:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">Hier_D=<span class="kw">HierD</span>(infile, <span class="dt">nreg=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">ncode=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">print</span>(Hier_D)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt;           D_gamma D_alpha.2 D_alpha.1 D_beta.2 D_beta.1 Differentiation.2</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; Locus 1  3.193142  2.725683  2.547081 1.171501 1.070120         0.1234638</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; Locus 2  8.127991  5.570462  4.756040 1.459123 1.171240         0.2947130</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; Locus 3  9.182470  7.039348  5.851804 1.304449 1.202936         0.2073097</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; Locus 4  8.384311  6.830226  5.819550 1.227531 1.173669         0.1599041</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; Locus 5  8.815656  6.014476  5.031749 1.465740 1.195305         0.2982420</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; Locus 6  4.466209  3.846453  3.517153 1.161124 1.093627         0.1165235</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; Locus 7  6.466375  4.320795  3.849778 1.496570 1.122349         0.3144786</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; Locus 8  8.193804  5.671722  4.805933 1.444677 1.180150         0.2869518</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; Locus 9  9.424112  5.279522  4.494791 1.785031 1.174587         0.4519619</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; Locus 10 8.429114  5.828401  5.117923 1.446214 1.138821         0.2877814</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt;          Differentiation.1</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; Locus 1         0.04546744</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; Locus 2         0.10604372</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; Locus 3         0.12395858</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; Locus 4         0.10743385</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; Locus 5         0.11968905</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; Locus 6         0.06004503</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; Locus 7         0.07743759</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; Locus 8         0.11112839</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; Locus 9         0.10795825</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; Locus 10        0.08721245</span></a></code></pre></div>
<p>Here we get alpha, beta, gamma diversity. D alpha1, D alpha2 and Dgamma correspond to number of equivalent alleles at population level, number of equivalent alleles at regional level, and total number of equivalent alleles at ecosystem. Beta.1 is the number of equivalent subaggregate (population or subpopulation depends on the hierarchy), and beta.2 is the number of equivalent aggregate (eg. regions). Differentiation.2 represents genetic differentiation between aggragates, Differentiation.1 represents genetic differentiation between subaggregates.</p>
<p>Untill now you may know how to implement the hierarchical diversity analysis. Furthermore, this package also includes several functions that can plot correlation between geographic distances and genetic differentiations, (see COR_Fstd, and COR_DeltaDd), as well as Delta D matrix and Delta D across loci.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<blockquote>
<p>’Gaggiotti, O. E., Chao, A., Peres-Neto, P., Chiu, C. H., Edwards, C., Fortin, M. J., … &amp; Selkoe, K. A. (2018). Diversity from genes to ecosystems: A unifying framework to study variation across biological metrics and scales. Evolutionary Applications.</p>
</blockquote>
<blockquote>
<p>’Weir, B.S. (1996) Genetic Data Analysis II. Sinauer Associates.</p>
</blockquote>
<blockquote>
<p>’Yang, R.C. (1998). Estimating hierarchical F-statistics. Evolution 52 (4):950-956</p>
</blockquote>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
